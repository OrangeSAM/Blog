(window.webpackJsonp=window.webpackJsonp||[]).push([[186],{386:function(a,s,t){"use strict";t.r(s);var e=t(3),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"_3-为什么需要构建工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-为什么需要构建工具"}},[a._v("#")]),a._v(" 3. 为什么需要构建工具")]),a._v(" "),t("ol",[t("li",[a._v("转换ES6语法")]),a._v(" "),t("li",[a._v("转换JSX")]),a._v(" "),t("li",[a._v("CSS前缀补全/预处理器")]),a._v(" "),t("li",[a._v("压缩混淆")]),a._v(" "),t("li",[a._v("图片压缩")])]),a._v(" "),t("h2",{attrs:{id:"_4-前端构建演变之路"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-前端构建演变之路"}},[a._v("#")]),a._v(" 4. 前端构建演变之路")]),a._v(" "),t("p",[t("code",[a._v("ant + YUI tool => grunt => fis3 gulp => rollup webpack parcel")])]),a._v(" "),t("h2",{attrs:{id:"_5-为什么选择webpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-为什么选择webpack"}},[a._v("#")]),a._v(" 5. 为什么选择webpack")]),a._v(" "),t("ol",[t("li",[a._v("社区生态丰富")]),a._v(" "),t("li",[a._v("配置灵活和插件化开发")]),a._v(" "),t("li",[a._v("官方更新迭代速度快")])]),a._v(" "),t("h2",{attrs:{id:"_6-初始webpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-初始webpack"}},[a._v("#")]),a._v(" 6. 初始webpack")]),a._v(" "),t("p",[a._v("webpack 默认配置文件：webpack.config.js")]),a._v(" "),t("p",[a._v("可以通过webpack --config 指定配置文件")]),a._v(" "),t("h2",{attrs:{id:"_10-通过npm-script-运行webpack"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-通过npm-script-运行webpack"}},[a._v("#")]),a._v(" 10. 通过npm script 运行webpack")]),a._v(" "),t("p",[a._v("原理：模板局部安装会在 node_modules/.bin 目录创建软链接")]),a._v(" "),t("h2",{attrs:{id:"_12-核心概念之loader"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12-核心概念之loader"}},[a._v("#")]),a._v(" 12. 核心概念之loader")]),a._v(" "),t("p",[a._v("webpack 开箱即用只支持js 和 json 两种文件类型，通过loaders 去支持其他文件类型并且把他们转换成有效的模块，\n并且可以添加到依赖图中。")]),a._v(" "),t("p",[a._v("本身是一个函数，接收源文件作为参数，返回转换的结果。\nbabel-loader  css-loader  less-loader ts-loader")]),a._v(" "),t("h2",{attrs:{id:"_13-核心概念之plugins"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_13-核心概念之plugins"}},[a._v("#")]),a._v(" 13. 核心概念之Plugins")]),a._v(" "),t("p",[a._v("插件用于bundle文件的优化，资源管理和环境变量的注入。\n作用于整个构建过程。\nCommonChunkPlugin 将chunks相同的模板代码提取成公共JS\nCleanWebpackPlugin 清理构建目录\nExtractTextWebpackPlugin 将CSS从bundle文件里提取成一个独立的CSS文件。\nUglifyjsWebpackPlugin 压缩JS\nZipWebpackPlugin 将打包出的资源生成一个zip包")]),a._v(" "),t("h2",{attrs:{id:"_14-核心概念之mode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-核心概念之mode"}},[a._v("#")]),a._v(" 14. 核心概念之Mode")]),a._v(" "),t("p",[a._v("Mode用来指定当前的构建环境是：production development 还是none。\n设置mode可以使用webpack内置的函数，默认值为production。\n"),t("code",[a._v("development")]),a._v(" 设置process.env.NODE_ENV 的值为development. 开启NamedChunkPlugin 和 NamedModulesPlugin\n"),t("code",[a._v("production")]),a._v(" 设置process.env.NODE_ENV 的值为production. 开启 FlagDependencyUsagePlugin等\n"),t("code",[a._v("none")]),a._v(" 不开启任何优化项\nwebpack 4才有的。")]),a._v(" "),t("h2",{attrs:{id:"_15-解析ecmascript-6和-react-jsx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-解析ecmascript-6和-react-jsx"}},[a._v("#")]),a._v(" 15. 解析"),t("code",[a._v("ECMAScript 6")]),a._v("和 "),t("code",[a._v("React JSX")])]),a._v(" "),t("h2",{attrs:{id:"_16-解析css、less和sass"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_16-解析css、less和sass"}},[a._v("#")]),a._v(" 16. 解析CSS、Less和Sass")]),a._v(" "),t("p",[a._v("css-loader 用于加载.css文件，并且转换CommonJs对象\nstyle-loader 将样式通过"),t("code",[a._v("<style>")]),a._v("标签插入到head中")]),a._v(" "),t("h2",{attrs:{id:"_17-解析图片和字体"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_17-解析图片和字体"}},[a._v("#")]),a._v(" 17. 解析图片和字体")]),a._v(" "),t("p",[a._v("file-loader 用于处理文件")]),a._v(" "),t("h2",{attrs:{id:"_18-webpack中的文件监听"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_18-webpack中的文件监听"}},[a._v("#")]),a._v(" 18. webpack中的文件监听")]),a._v(" "),t("p",[a._v("文件监听是在发现源码发生变化时，自动重新构建出新的输出文件。")]),a._v(" "),t("p",[a._v("webpack 开启监听模式，有两种方式。")]),a._v(" "),t("ul",[t("li",[a._v("在启动webpack命令时，带上--watch参数")]),a._v(" "),t("li",[a._v("在配置webpack.config.js中设置watch: true")])]),a._v(" "),t("p",[a._v("文件监听的原理\n轮询判断文件的最后编辑时间是否发生变化。\n某个文件发生了变化，并不会立刻告诉监听者，而是先缓存起来，等aggregateTimeout。\naggregate(总数的，总计的，聚合的)")]),a._v(" "),t("p",[a._v("配置：")]),a._v(" "),t("div",{staticClass:"language-javascript line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[a._v("module"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("export  "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 默认false, 即不开启")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("watch")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 只有开启监听模式，watchOptions才有意义")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("watchOptions")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 默认为空，不监听的文件或者文件夹，支持正则匹配")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("ignored")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token regex"}},[t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[a._v("/")]),t("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[a._v("node_modules")]),t("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[a._v("/")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 监听到变化发生后会等300ms再去执行，默认300ms")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("aggregateTimeout")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("300")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("poll")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br")])]),t("h2",{attrs:{id:"_19-webpack中的热更新及原理分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_19-webpack中的热更新及原理分析"}},[a._v("#")]),a._v(" 19. webpack中的热更新及原理分析")]),a._v(" "),t("p",[a._v("热更新 webpack-dev-server\nwds 不刷新浏览器\nwds 不输出文件，而是放在内存中\n使用hotModuleReplacementPlugin插件\n// 构建完自动打开浏览器\n"),t("code",[a._v('"dev": "webpack-dev-server --open"')])]),a._v(" "),t("p",[a._v("另一个选择，使用webpack-dev-middleware\nWDM将webpack输出的文件传输给服务器\n适用于灵活的定制场景\n"),t("strong",[a._v("原理分析")]),a._v("\nwebpack Compile将JS编译成bundle\nHMR Server将热更新的文件输出给HMR runtime\nBundle Server提供文件在浏览器的访问\nHMR Runtime 会被注入到浏览器、更新文件的变化\nbundle.js 构建输出的文件")]),a._v(" "),t("h2",{attrs:{id:"_20-文件指纹策略-chunkhash、contenthash和hash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_20-文件指纹策略-chunkhash、contenthash和hash"}},[a._v("#")]),a._v(" 20. 文件指纹策略 chunkhash、contenthash和hash")]),a._v(" "),t("ol",[t("li",[t("p",[a._v("什么是文件指纹\n打包后输出的文件名的后缀")])]),a._v(" "),t("li",[t("p",[a._v("文件指纹如何生成\n"),t("code",[a._v("Hash")]),a._v(": 和整个项目的构建有关，只要项目文件有修改，整个项目构建的hash值就会更改\n"),t("code",[a._v("Chunkhash")]),a._v("：和webpack打包的chunk有关，不同的entry会生成不同的chunkhash值\n"),t("code",[a._v("Contenthash")]),a._v(": 根据文件内容来定义hash，文件内容不变，则content不变")])]),a._v(" "),t("li",[t("p",[a._v("js的文件指纹设置\n设置output的filename，使用[chunkhash]\n"),t("code",[a._v("filename: '[name][chunkHash:8].js'")])])]),a._v(" "),t("li",[t("p",[a._v("css的文件指纹设置\n设置miniCssExtractPlugin的fileName, 使用[contenthash]")])])]),a._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"plugins"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n  new MiniCssExtractPlugin("),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  fileName"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("contenthash"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(".css\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(")\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("设置fileLoader的name, 使用[hash]\n占位符名称  含义\n[ext]   资源后缀名\n[name]  文件名称\n[path]  文件的相对路径\n[folder]    文件所在的文件夹\n[contenthash]   文件的内容hash, 默认是md5生成\n[hash]  文件的内容hash, 默认是md5生成\n[emoji] 一个随机的自带文件内容的emoji")])]),a._v(" "),t("h2",{attrs:{id:"_21-html、css和javascript代码压缩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_21-html、css和javascript代码压缩"}},[a._v("#")]),a._v(" 21. HTML、CSS和JavaScript代码压缩")]),a._v(" "),t("ol",[t("li",[a._v("JS文件的压缩\nwebpack4内置了uglifyjs-webpack-plugin")]),a._v(" "),t("li",[a._v("CSS文件的压缩\n使用optimize-css-assets-webpack-plugin\n同时使用cssnano")]),a._v(" "),t("li",[a._v("HTMl文件的压缩\n修改html-webpack-plugin，设置压缩参数")])]),a._v(" "),t("h2",{attrs:{id:"_22-自动清理构建目录产物"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_22-自动清理构建目录产物"}},[a._v("#")]),a._v(" 22. 自动清理构建目录产物")]),a._v(" "),t("p",[a._v("当前的构建问题：\n每次构建的时候不会清理目录，造成构建的输出目录output文件越来越多。\nrm -rf ./dist && webpack // 不优雅")]),a._v(" "),t("p",[a._v("插件\n使用clean-webpack-plugin\n· 默认会删除output指定的输出目录")])])}),[],!1,null,null,null);s.default=n.exports}}]);