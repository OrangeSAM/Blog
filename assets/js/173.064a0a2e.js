(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{372:function(s,t,n){"use strict";n.r(t);var a=n(3),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_1-vue全家桶原理和实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-vue全家桶原理和实现"}},[s._v("#")]),s._v(" 1. Vue全家桶原理和实现")]),s._v(" "),n("h3",{attrs:{id:"问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[s._v("#")]),s._v(" 问题")]),s._v(" "),n("ol",[n("li",[s._v("Vue.use到底做了什么\n"),n("ol",[n("li",[s._v("目的是安装Vue插件")]),s._v(" "),n("li",[s._v("会将Vue作为参数传入插件的install方法(如果插件是个函数，那么他就是install方法本身)")]),s._v(" "),n("li",[s._v("Vue.use的核心方法在"),n("code",[s._v("src/core/global-api/use.js")]),s._v("下\n"),n("ol",[n("li",[s._v("总计不到20行，核心逻辑如下")]),s._v(" "),n("li",[s._v("获取已安装的插件数组，如果存在则直接返回this")]),s._v(" "),n("li",[s._v("不存在则执行插件的install方法")])])])])]),s._v(" "),n("li",[s._v("为什么要把router的实例挂载到Vue实例的选项中\n1.")]),s._v(" "),n("li",[s._v("为什么要加上router-view")]),s._v(" "),n("li",[s._v("为什么可以直接用router-link和router-view")])]),s._v(" "),n("h3",{attrs:{id:"官方文档中的插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#官方文档中的插件"}},[s._v("#")]),s._v(" 官方文档中的插件")]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[s._v("Vue.use( plugin )\n参数：\n\n{Object | Function} plugin\n用法：\n\n安装 Vue.js 插件。如果插件是一个对象，必须提供 install 方法。如果插件是一个函数，它会被作为 install 方法。install 方法调用时，会将 Vue 作为参数传入。\n\n该方法需要在调用 new Vue() 之前被调用。\n\n当 install 方法被同一个插件多次调用，插件将只会被安装一次。\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[s._v("Vue.js 的插件应该暴露一个 install 方法。这个方法的第一个参数是 Vue 构造器，第二个参数是一个可选的选项对象：\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("MyPlugin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("install")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1. 添加全局方法或 property")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("myGlobalMethod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 逻辑...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2. 添加全局资源")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("directive")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my-directive'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("bind")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("el"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" binding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vnode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" oldVnode")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 逻辑...")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3. 注入组件选项")]),s._v("\n  Vue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mixin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("created")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 逻辑...")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 4. 添加实例方法")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("prototype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("$myMethod")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("methodOptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 逻辑...")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h3",{attrs:{id:"vue-router需求分析"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue-router需求分析"}},[s._v("#")]),s._v(" Vue-Router需求分析")]),s._v(" "),n("p",[s._v("单页面应用程序中，url发生变化时候，不能刷新，显示对应视图内容")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("SPA页面不能刷新")]),s._v(" "),n("ul",[n("li",[s._v("hash （#/about")]),s._v(" "),n("li",[s._v("history （api /about")])])]),s._v(" "),n("li",[n("p",[s._v("根据url显示对应的内容")]),s._v(" "),n("ul",[n("li",[s._v("router-view")]),s._v(" "),n("li",[s._v("数据响应式：current变量持有url地址，一旦变化，动态重新执行render")])])])]),s._v(" "),n("h3",{attrs:{id:"思路"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#思路"}},[s._v("#")]),s._v(" 思路")]),s._v(" "),n("ol",[n("li",[s._v("实现一个插件\n"),n("ul",[n("li",[s._v("实现VueRouter类\n"),n("ul",[n("li",[s._v("处理路由选项")]),s._v(" "),n("li",[s._v("监控url变化，hashchange")]),s._v(" "),n("li",[s._v("响应这个变化")])])]),s._v(" "),n("li",[s._v("实现install方法\n"),n("ul",[n("li",[s._v("$router注册")]),s._v(" "),n("li",[s._v("两个全局组件")])])])])])]),s._v(" "),n("h3",{attrs:{id:"笔记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#笔记"}},[s._v("#")]),s._v(" 笔记")]),s._v(" "),n("ol",[n("li",[s._v("this.$options 获得当前组件的选项配置")]),s._v(" "),n("li",[s._v("h 函数是什么，\n"),n("ul",[n("li",[s._v("h是render函数调用是，框架传入的createElement")]),s._v(" "),n("li",[s._v("等同于react中createElement，返回vdom")]),s._v(" "),n("li",[s._v("再多研究下")])])]),s._v(" "),n("li",[s._v("什么是jsx")]),s._v(" "),n("li",[s._v("Vue.util. defineReactive()")]),s._v(" "),n("li",[s._v("再研究下Object.defineProperty")]),s._v(" "),n("li",[s._v("vue插件的核心\n"),n("ul",[n("li",[s._v("提供一个名为install的方法")]),s._v(" "),n("li",[s._v("Vue.use的时候会调用这个方法")]),s._v(" "),n("li",[s._v("（所以可以理解我们在用组件库的时候，Vue.use其实就是全局注册了那个组件罢了，当然，install远不止可以做组件注册的事。）")]),s._v(" "),n("li",[s._v("来自官方文档：安装 Vue.js 插件。如果插件是一个对象，必须提供 install 方法。\n如果插件是一个函数，它会被作为 install 方法。install 方法调用时，会将 Vue 作为参数传入。\n该方法需要在调用 new Vue() 之前被调用。")]),s._v(" "),n("li",[s._v("Vue.use 中的Vue是一个构造函数，而不是一个实例")]),s._v(" "),n("li",[s._v("从Vue源码中可以发现，Use函数的参数应该是函数或者对象\n"),n("ul",[n("li",[s._v("export function initUse (Vue: GlobalAPI) {\nVue.use = function (plugin: Function | Object) {}\n}")])])])])]),s._v(" "),n("li",[s._v("new Vue({\nrouter,\nstore,\nrender: h => h(App)\n}).$mount('#app')\nrouter只能在根实例中拿到")]),s._v(" "),n("li",[s._v("Vue.Component的参数及用法\n"),n("ul",[n("li",[s._v("参数：\n"),n("ul",[n("li",[s._v("{string} id")]),s._v(" "),n("li",[s._v("{Function | Object} [definition]")])])]),s._v(" "),n("li",[s._v("用法：\n"),n("ul",[n("li",[s._v("注册或获取全局组件。注册还会自动使用给定的 id 设置组件的名称")]),s._v(" "),n("li",[s._v("// 注册组件，传入一个扩展过的构造器")]),s._v(" "),n("li",[s._v("Vue.component('my-component', Vue.extend({ /* ... */ }))")]),s._v(" "),n("li",[s._v("// 注册组件，传入一个选项对象 (自动调用 Vue.extend)")]),s._v(" "),n("li",[s._v("Vue.component('my-component', { /* ... */ }) // 常用")]),s._v(" "),n("li",[s._v("// 获取注册的组件 (始终返回构造器)")]),s._v(" "),n("li",[s._v("var MyComponent = Vue.component('my-component')\n我们注册组件的常用无非如下两种，但实际都是借助component实现的，区别在于手动和自动")])])]),s._v(" "),n("li",[s._v("Vue.use(SForm)")]),s._v(" "),n("li",[s._v("Vue.component('SForm', SForm)")])])]),s._v(" "),n("li",[n("img",{attrs:{src:"https://i.loli.net/2021/07/10/AJlxji5vCV9EOFH.png",alt:""}}),s._v("\n从如上图可以看出，只有根实例的options中才有传入的VueRouter实例，但是每个组件都能直接获取到VueRouter\n但又感到迷惑的是，每个子组件上都直接的拥有$router属性，本以为是挂载Vue的原型上，顺着原型链去获取使用的，#迷惑\n10.Vue生态内实现数据响应式的两个方案，vue.util.defineReactive && new Vue({})")])]),s._v(" "),n("h3",{attrs:{id:"疑惑"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#疑惑"}},[s._v("#")]),s._v(" 疑惑")]),s._v(" "),n("ol",[n("li",[s._v("在视频59‘左右说到，在实现router-view的时候不能直接写模板，因为我们cli环境下，用的是runtime版本的vue。\n疑惑在于，我们写业务代码不是写了很多模板吗，为什么就可以呢。临时贴图如下。\n"),n("img",{attrs:{src:"https://s2.loli.net/2021/12/19/tbBgV2ZFaixD6jI.png",alt:""}})])]),s._v(" "),n("p",[s._v("重看到1.30分")]),s._v(" "),n("h3",{attrs:{id:"作业"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#作业"}},[s._v("#")]),s._v(" 作业")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("解决router无限循环的问题")])]),s._v(" "),n("li",[n("p",[s._v("实现getters")])])]),s._v(" "),n("p",[n("em",[s._v("写第一课作业实现getters遇到的问题")])]),s._v(" "),n("ol",[n("li",[s._v("getters本质上就是用户给我们一个函数的实现，当用户在使用这个函数的时候，通过运算这个函数为用户返回一个确认的值。")]),s._v(" "),n("li",[s._v("像commit那样处理getters的话，为啥getters没反应（更新，因为getters不是函数）")]),s._v(" "),n("li",[s._v("后面又觉得应该像state那样处理getters，但是get方法不能拿到参数")]),s._v(" "),n("li")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("state")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 我想为这个getters bind 到当前state上，但是我不知道他的getters是啥")]),s._v("\n   "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$$state\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("最开始我是没有很明确的思路，看到state、commit和dispatch的实现就想着先照着抄。但实际上后面就陷阱里头了。\n现在醒悟过来分析一看，state的实现思路是一类，commit和dispatch的实现思路又是一类。state只需要实现获取就好了，后两个是需要实现方法。\n但这两者的思路，getters都套用不上。")]),s._v(" "),n("p",[n("em",[s._v("错误思路一")]),s._v("，这个思路没用的原因是getters点出来的东西不是个函数，他是一个直接取的动作。所以如下的方法不会被触发。有点牛头不对马嘴的感觉。")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[s._v("  "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getters")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 拿到的value，应该是用户想要用的getters，比如这里的doubleCounter")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" getter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("_getters")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("getter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'unknown getters'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("state"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[n("em",[s._v("错误思路二")]),s._v("，这个思路是完全走到了死胡同。问题在于，get不知道当前用户点的是啥。")]),s._v(" "),n("div",{staticClass:"language-javascript line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("get")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getters")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 我想为这个getters bind 到当前state上，但是我不知道他的getters是啥")]),s._v("\n  console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$$getters"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_vm"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("_data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("$$getters\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("getters")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("v")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'222'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("hr"),s._v(" "),n("h2",{attrs:{id:"_2-手写vue"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-手写vue"}},[s._v("#")]),s._v(" 2. 手写Vue")]),s._v(" "),n("p",[s._v("更新dom的两种策略")]),s._v(" "),n("ol",[n("li",[n("p",[s._v("一块视图对应一个updater，数据更新，对应的视图就会被更新")])]),s._v(" "),n("li",[n("p",[s._v("使用虚拟dom，更新视图的事交给patch去解决 // patch(oldvdom, vdom)\n数据响应式原理\nObject.defineProperty()\nVue.util.defineReactive()\nVue.observable()\nnew Vue({\ndata(){}\n})")])]),s._v(" "),n("li",[n("p",[s._v("MVVM框架的三要素：数据响应式、模板引擎及其渲染")])])]),s._v(" "),n("p",[s._v("依赖收集")]),s._v(" "),n("h2",{attrs:{id:"_3-vue2源码剖析01"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-vue2源码剖析01"}},[s._v("#")]),s._v(" 3. Vue2源码剖析01")]),s._v(" "),n("div",{staticClass:"language-markdown line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-markdown"}},[n("code",[s._v("\n.\n|-vue\n  |-.circleci\n  |-.git\n  |-.github\n  |-.idea\n  |-benchmarks\n  |-dist\n  |-examples // 范例\n  |-flow\n  |-packages // 核心代码之外的独立库\n  |  |-vue-server-renderer\n  |  |  |-types\n  |  |-vue-template-compiler\n  |  |  |-types\n  |  |-weex-template-compiler\n  |  |-weex-vue-framework\n  |-scripts // 构建脚本\n  |  |-git-hooks\n  |-src // 源码\n  |  |-compiler // 编译器相关\n  |  |  |-codegen\n  |  |  |-directives\n  |  |  |-parser\n  |  |-core // 核心代码，重要\n  |  |  |-components // 通用组件如keep-alive\n  |  |  |-global-api // 全局api Vue.component\n  |  |  |-instance // 构造函数\n  |  |  |-observer // 响应式相关\n  |  |  |-util\n  |  |  |-vdom // 虚拟dom\n  |  |-platforms\n  |  |  |-web\n  |  |  |  |-compiler\n  |  |  |  |-runtime\n  |  |  |  |-server\n  |  |  |  |-util\n  |  |  |-weex\n  |  |-server\n  |  |  |-bundle-renderer\n  |  |  |-optimizing-compiler\n  |  |  |-template-renderer\n  |  |  |-webpack-plugin\n  |  |-sfc\n  |  |-shared\n  |-test\n  |-types // ts 类型声明，上面flow是针对flow的类型声明\n  |  |-test\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br")])]),n("p",[s._v("运行时和编译器又是啥")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("版本\\模块化方式")]),s._v(" "),n("th",[s._v("UMD")]),s._v(" "),n("th",[s._v("CommonJS")]),s._v(" "),n("th",[s._v("ES Module(基于构建工具使用)")]),s._v(" "),n("th",[s._v("ES Module(直接用于浏览器)")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("完整版")]),s._v(" "),n("td",[s._v("vue.js")]),s._v(" "),n("td",[s._v("vue.common.js")]),s._v(" "),n("td",[s._v("vue.esm.js")]),s._v(" "),n("td",[s._v("vue.esm.browser.js")])]),s._v(" "),n("tr",[n("td",[s._v("只包含运行时版")]),s._v(" "),n("td",[s._v("vue.runtime.js")]),s._v(" "),n("td",[s._v("vue.runtime.common.js")]),s._v(" "),n("td",[s._v("vue.runtime.esm.js")]),s._v(" "),n("td",[s._v("-")])]),s._v(" "),n("tr",[n("td",[s._v("完整版(生产环境)")]),s._v(" "),n("td",[s._v("vue.min.js")]),s._v(" "),n("td",[s._v("-")]),s._v(" "),n("td",[s._v("-")]),s._v(" "),n("td",[s._v("vue.esm.browser.min.js")])]),s._v(" "),n("tr",[n("td",[s._v("只包含运行时版(生产环境)")]),s._v(" "),n("td",[s._v("vue.runtime.min.js")]),s._v(" "),n("td",[s._v("-")]),s._v(" "),n("td",[s._v("-")]),s._v(" "),n("td",[s._v("-")])])])]),s._v(" "),n("ul",[n("li",[n("em",[s._v("完整版")]),s._v("： 同时包含编译器和运行时的版本")]),s._v(" "),n("li",[n("em",[s._v("编译器")]),s._v("： 用来将模板字符串编译成为JavaScript渲染函数的代码")]),s._v(" "),n("li",[n("em",[s._v("运行时")]),s._v("： 用来创建Vue实例，渲染并处理虚拟DOM等的代码，基本就是除去编译器的其他一切")]),s._v(" "),n("li",[n("em",[s._v("UMD")]),s._v("  ： UMD版本可以通过"),n("code",[s._v("<script>")]),s._v("标签直接用在浏览器上")]),s._v(" "),n("li",[n("em",[s._v("CommonJS")]),s._v("：CommonJS版本用来配合老的打包工具比如Browserify 或webpack1，这些打包工具的默认文件pkg.main是只包含运行时的CommonJS版本(Vue.runtime.common.js)")]),s._v(" "),n("li",[n("em",[s._v("ES Module")]),s._v("： 为打包工具提供的ESM(webpack2、Rollup)；为浏览器提供的ESM")])]),s._v(" "),n("ol",[n("li",[n("p",[s._v("为啥webpack打包不需要编译器版本的？21.45")])]),s._v(" "),n("li",[n("p",[s._v("把new vue到页面渲染的全流程写下来，直到页面呈现")])]),s._v(" "),n("li",[n("p",[s._v("各种文件")]),s._v(" "),n("ul",[n("li",[s._v("src/platforms/web/entry-runtime-with-compiler.js\n"),n("ul",[n("li",[s._v("打包入口文件，拓展$mount")])])]),s._v(" "),n("li",[s._v("src/platforms/web/runtime/index.js\n"),n("ul",[n("li",[s._v("安装平台特有patch函数，patch作用是将vdom转换为dom\n"),n("ul",[n("li",[s._v("init 完整创建")]),s._v(" "),n("li",[s._v("update diff oldvnode & vnode")])])]),s._v(" "),n("li",[s._v("实现挂载方法")])])]),s._v(" "),n("li",[s._v("src/core/index.js\n"),n("ul",[n("li",[s._v("初始化所有全局API Vue.component/filter")])])]),s._v(" "),n("li",[s._v("src/core/instance/index.js\n"),n("ul",[n("li",[s._v("声明Vue")])])]),s._v(" "),n("li",[s._v("src/core/instance/init.js\n"),n("ul",[n("li",[s._v("初始化Vue")])])]),s._v(" "),n("li",[s._v("src/core/instance/lifecycle.js\n"),n("ul",[n("li",[s._v("挂载")]),s._v(" "),n("li",[s._v("updateComponent")]),s._v(" "),n("li",[s._v("new Watcher 一个组件一个watcher")]),s._v(" "),n("li",[s._v("执行render获得虚拟dom")]),s._v(" "),n("li",[s._v("patch => dom")])])])])])]),s._v(" "),n("p",[s._v("浏览器快捷键\n打开文件 ctrl + p\n运行命令 ctrl + shift + p\nD:\\Repo\\openSource\\famous\\vue\\src\\platforms\\web\\entry-runtime-with-compiler.js // 打包入口文件\nrender > template > el")]),s._v(" "),n("h2",{attrs:{id:"vue2源码剖析02"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue2源码剖析02"}},[s._v("#")]),s._v(" Vue2源码剖析02")]),s._v(" "),n("h2",{attrs:{id:"vue2源码剖析03"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue2源码剖析03"}},[s._v("#")]),s._v(" Vue2源码剖析03")]),s._v(" "),n("h2",{attrs:{id:"_6-vue组件化实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-vue组件化实践"}},[s._v("#")]),s._v(" 6.Vue组件化实践")]),s._v(" "),n("p",[s._v("slotProps")]),s._v(" "),n("h2",{attrs:{id:"vue2源码剖析03-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#vue2源码剖析03-2"}},[s._v("#")]),s._v(" Vue2源码剖析03")]),s._v(" "),n("ol",[n("li",[s._v("父子组件的创建挂载")])]),s._v(" "),n("ul",[n("li",[s._v("创建过程自上而下")]),s._v(" "),n("li",[s._v("挂载过程自下而上")]),s._v(" "),n("li",[s._v("异步组件另当别论\nparent\ncreated\nchild\ncreated\nmounted\nmounted")])])])}),[],!1,null,null,null);t.default=e.exports}}]);