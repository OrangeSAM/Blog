<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript 和 Node.js 中的模块化 | 刘一笔的博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-0X7CLSMP1X"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-0X7CLSMP1X');</script>
    <link rel="icon" href="/logo.jpg">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/logo.jpg">
    <link rel="mask-icon" href="/logo.jpg" color="#3eaf7c">
    <meta name="description" content="博客，日常记录，JavaScript，CSS，LeetCode，Node，HTTP">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/logo.jpg">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.a0dd32a5.css" as="style"><link rel="preload" href="/assets/js/app.76e21587.js" as="script"><link rel="preload" href="/assets/js/2.ef2f9e2c.js" as="script"><link rel="preload" href="/assets/js/115.8f904d78.js" as="script"><link rel="preload" href="/assets/js/3.1b3369a5.js" as="script"><link rel="prefetch" href="/assets/js/10.ef5f6156.js"><link rel="prefetch" href="/assets/js/100.2d3d65dc.js"><link rel="prefetch" href="/assets/js/101.3541b6a3.js"><link rel="prefetch" href="/assets/js/102.7c015d2f.js"><link rel="prefetch" href="/assets/js/103.1a2d5336.js"><link rel="prefetch" href="/assets/js/104.0b32bea5.js"><link rel="prefetch" href="/assets/js/105.a78d4b43.js"><link rel="prefetch" href="/assets/js/106.ee861420.js"><link rel="prefetch" href="/assets/js/107.1589de3b.js"><link rel="prefetch" href="/assets/js/108.8c652294.js"><link rel="prefetch" href="/assets/js/109.82572f5c.js"><link rel="prefetch" href="/assets/js/11.ff160937.js"><link rel="prefetch" href="/assets/js/110.f7df9431.js"><link rel="prefetch" href="/assets/js/111.c12b7478.js"><link rel="prefetch" href="/assets/js/112.f1219cc2.js"><link rel="prefetch" href="/assets/js/113.eb0a1acb.js"><link rel="prefetch" href="/assets/js/114.f8b5ecc0.js"><link rel="prefetch" href="/assets/js/116.46d26f9e.js"><link rel="prefetch" href="/assets/js/117.1b9742b9.js"><link rel="prefetch" href="/assets/js/118.83e370a4.js"><link rel="prefetch" href="/assets/js/119.16d4b644.js"><link rel="prefetch" href="/assets/js/12.e7ddc629.js"><link rel="prefetch" href="/assets/js/120.4a2435e3.js"><link rel="prefetch" href="/assets/js/121.148a13b1.js"><link rel="prefetch" href="/assets/js/122.975f6573.js"><link rel="prefetch" href="/assets/js/123.2bf384b5.js"><link rel="prefetch" href="/assets/js/124.2f08b951.js"><link rel="prefetch" href="/assets/js/125.2daa33a2.js"><link rel="prefetch" href="/assets/js/126.325ac660.js"><link rel="prefetch" href="/assets/js/127.7b208fea.js"><link rel="prefetch" href="/assets/js/128.51febaca.js"><link rel="prefetch" href="/assets/js/129.02cd3d89.js"><link rel="prefetch" href="/assets/js/13.e4441820.js"><link rel="prefetch" href="/assets/js/130.fabb7a6e.js"><link rel="prefetch" href="/assets/js/131.d5c59711.js"><link rel="prefetch" href="/assets/js/132.be868018.js"><link rel="prefetch" href="/assets/js/133.437d7062.js"><link rel="prefetch" href="/assets/js/134.c3e73e8b.js"><link rel="prefetch" href="/assets/js/135.23adb045.js"><link rel="prefetch" href="/assets/js/136.99c7ff32.js"><link rel="prefetch" href="/assets/js/137.b3fa1902.js"><link rel="prefetch" href="/assets/js/138.3dc8243b.js"><link rel="prefetch" href="/assets/js/139.3d892819.js"><link rel="prefetch" href="/assets/js/14.0ce04f59.js"><link rel="prefetch" href="/assets/js/140.9d7f60be.js"><link rel="prefetch" href="/assets/js/141.32b2b2da.js"><link rel="prefetch" href="/assets/js/142.00adaa85.js"><link rel="prefetch" href="/assets/js/143.bb7be1f6.js"><link rel="prefetch" href="/assets/js/144.45d47fb4.js"><link rel="prefetch" href="/assets/js/145.5652003b.js"><link rel="prefetch" href="/assets/js/146.81f064b1.js"><link rel="prefetch" href="/assets/js/147.43ace8a8.js"><link rel="prefetch" href="/assets/js/148.a1958ea5.js"><link rel="prefetch" href="/assets/js/149.0793fb2c.js"><link rel="prefetch" href="/assets/js/15.e40754cd.js"><link rel="prefetch" href="/assets/js/150.e6d8665e.js"><link rel="prefetch" href="/assets/js/151.6741ea95.js"><link rel="prefetch" href="/assets/js/152.6329f925.js"><link rel="prefetch" href="/assets/js/153.f0413f7e.js"><link rel="prefetch" href="/assets/js/154.04389ff6.js"><link rel="prefetch" href="/assets/js/155.b36365ee.js"><link rel="prefetch" href="/assets/js/156.61f7e004.js"><link rel="prefetch" href="/assets/js/157.28ce74b7.js"><link rel="prefetch" href="/assets/js/158.ba82dbcc.js"><link rel="prefetch" href="/assets/js/159.27165b72.js"><link rel="prefetch" href="/assets/js/16.ae79c6db.js"><link rel="prefetch" href="/assets/js/160.7d39c132.js"><link rel="prefetch" href="/assets/js/161.18fd3af5.js"><link rel="prefetch" href="/assets/js/162.1fd5bed5.js"><link rel="prefetch" href="/assets/js/163.93003a90.js"><link rel="prefetch" href="/assets/js/164.2547e16f.js"><link rel="prefetch" href="/assets/js/165.d37c669f.js"><link rel="prefetch" href="/assets/js/166.9642024f.js"><link rel="prefetch" href="/assets/js/167.5547deb5.js"><link rel="prefetch" href="/assets/js/168.8f2d1d31.js"><link rel="prefetch" href="/assets/js/169.7ae0f6f2.js"><link rel="prefetch" href="/assets/js/17.1e9c8d00.js"><link rel="prefetch" href="/assets/js/170.3d306df7.js"><link rel="prefetch" href="/assets/js/171.11f0a8dd.js"><link rel="prefetch" href="/assets/js/172.3e3ea2ca.js"><link rel="prefetch" href="/assets/js/173.064a0a2e.js"><link rel="prefetch" href="/assets/js/174.0682728b.js"><link rel="prefetch" href="/assets/js/175.8a116a6d.js"><link rel="prefetch" href="/assets/js/176.cd54dfa8.js"><link rel="prefetch" href="/assets/js/177.d9c4fb82.js"><link rel="prefetch" href="/assets/js/178.5266f65f.js"><link rel="prefetch" href="/assets/js/179.2820ef56.js"><link rel="prefetch" href="/assets/js/18.443f25cc.js"><link rel="prefetch" href="/assets/js/180.ca4b4232.js"><link rel="prefetch" href="/assets/js/181.8a4c793e.js"><link rel="prefetch" href="/assets/js/182.94a0c965.js"><link rel="prefetch" href="/assets/js/183.cca63305.js"><link rel="prefetch" href="/assets/js/184.9825e05e.js"><link rel="prefetch" href="/assets/js/185.e34ca234.js"><link rel="prefetch" href="/assets/js/186.54eae001.js"><link rel="prefetch" href="/assets/js/187.88e3c084.js"><link rel="prefetch" href="/assets/js/188.580b07bc.js"><link rel="prefetch" href="/assets/js/189.3b14397a.js"><link rel="prefetch" href="/assets/js/19.0ee16591.js"><link rel="prefetch" href="/assets/js/190.4f9d4c49.js"><link rel="prefetch" href="/assets/js/191.dcf8c1b9.js"><link rel="prefetch" href="/assets/js/192.c1b4bce7.js"><link rel="prefetch" href="/assets/js/193.93731a06.js"><link rel="prefetch" href="/assets/js/194.586b98be.js"><link rel="prefetch" href="/assets/js/195.4de65e31.js"><link rel="prefetch" href="/assets/js/196.71a60f4c.js"><link rel="prefetch" href="/assets/js/197.1695f600.js"><link rel="prefetch" href="/assets/js/198.060d90ab.js"><link rel="prefetch" href="/assets/js/199.1260bbfa.js"><link rel="prefetch" href="/assets/js/20.f61ba541.js"><link rel="prefetch" href="/assets/js/200.979021f3.js"><link rel="prefetch" href="/assets/js/201.30080dfd.js"><link rel="prefetch" href="/assets/js/202.7e1e7257.js"><link rel="prefetch" href="/assets/js/203.ea8a7380.js"><link rel="prefetch" href="/assets/js/204.1e4a1f7a.js"><link rel="prefetch" href="/assets/js/205.1407fde9.js"><link rel="prefetch" href="/assets/js/206.fc65d02a.js"><link rel="prefetch" href="/assets/js/207.0d3b3dc1.js"><link rel="prefetch" href="/assets/js/208.48aa8317.js"><link rel="prefetch" href="/assets/js/209.2c17a3e6.js"><link rel="prefetch" href="/assets/js/21.973e996b.js"><link rel="prefetch" href="/assets/js/210.6567fcfe.js"><link rel="prefetch" href="/assets/js/211.1e295685.js"><link rel="prefetch" href="/assets/js/212.5e8b606f.js"><link rel="prefetch" href="/assets/js/213.0b2763c8.js"><link rel="prefetch" href="/assets/js/214.33042666.js"><link rel="prefetch" href="/assets/js/215.0bf677cb.js"><link rel="prefetch" href="/assets/js/216.d1f864a8.js"><link rel="prefetch" href="/assets/js/217.de1dbf6a.js"><link rel="prefetch" href="/assets/js/218.cb5d042d.js"><link rel="prefetch" href="/assets/js/219.23078b70.js"><link rel="prefetch" href="/assets/js/22.144f30cf.js"><link rel="prefetch" href="/assets/js/220.c0d00f42.js"><link rel="prefetch" href="/assets/js/221.e1453a03.js"><link rel="prefetch" href="/assets/js/222.f632daba.js"><link rel="prefetch" href="/assets/js/223.96902b87.js"><link rel="prefetch" href="/assets/js/224.c645a1c5.js"><link rel="prefetch" href="/assets/js/225.b740062f.js"><link rel="prefetch" href="/assets/js/226.67c591a1.js"><link rel="prefetch" href="/assets/js/227.9bbd2037.js"><link rel="prefetch" href="/assets/js/228.690fa881.js"><link rel="prefetch" href="/assets/js/229.8de9953d.js"><link rel="prefetch" href="/assets/js/23.bce43dff.js"><link rel="prefetch" href="/assets/js/230.65451e2a.js"><link rel="prefetch" href="/assets/js/231.14aa679c.js"><link rel="prefetch" href="/assets/js/232.164fdd38.js"><link rel="prefetch" href="/assets/js/233.657c198c.js"><link rel="prefetch" href="/assets/js/234.17274014.js"><link rel="prefetch" href="/assets/js/235.e335f0d1.js"><link rel="prefetch" href="/assets/js/236.21236351.js"><link rel="prefetch" href="/assets/js/237.ff765469.js"><link rel="prefetch" href="/assets/js/238.448c8d5d.js"><link rel="prefetch" href="/assets/js/239.12b1f06d.js"><link rel="prefetch" href="/assets/js/24.b281424d.js"><link rel="prefetch" href="/assets/js/240.52b3c1fe.js"><link rel="prefetch" href="/assets/js/241.592561ae.js"><link rel="prefetch" href="/assets/js/242.6d4c84fe.js"><link rel="prefetch" href="/assets/js/243.6b2803ac.js"><link rel="prefetch" href="/assets/js/244.722b598b.js"><link rel="prefetch" href="/assets/js/245.751ae5aa.js"><link rel="prefetch" href="/assets/js/246.f4460d4b.js"><link rel="prefetch" href="/assets/js/247.43791c9b.js"><link rel="prefetch" href="/assets/js/248.c8b055d4.js"><link rel="prefetch" href="/assets/js/249.e15c0a8a.js"><link rel="prefetch" href="/assets/js/25.349950c9.js"><link rel="prefetch" href="/assets/js/250.8ec249be.js"><link rel="prefetch" href="/assets/js/251.f4faa633.js"><link rel="prefetch" href="/assets/js/252.3731b04b.js"><link rel="prefetch" href="/assets/js/253.effbb760.js"><link rel="prefetch" href="/assets/js/254.f1347bdc.js"><link rel="prefetch" href="/assets/js/255.cf6f2e8a.js"><link rel="prefetch" href="/assets/js/256.a2c06947.js"><link rel="prefetch" href="/assets/js/257.f159321a.js"><link rel="prefetch" href="/assets/js/258.a2870a2a.js"><link rel="prefetch" href="/assets/js/259.3a70c2b7.js"><link rel="prefetch" href="/assets/js/26.cda2690c.js"><link rel="prefetch" href="/assets/js/260.d2ff937d.js"><link rel="prefetch" href="/assets/js/261.0a00e629.js"><link rel="prefetch" href="/assets/js/262.3236e5d6.js"><link rel="prefetch" href="/assets/js/263.18328b50.js"><link rel="prefetch" href="/assets/js/264.f0750871.js"><link rel="prefetch" href="/assets/js/265.5934a2d5.js"><link rel="prefetch" href="/assets/js/266.866a22b3.js"><link rel="prefetch" href="/assets/js/267.b55e7fc1.js"><link rel="prefetch" href="/assets/js/268.3c5a59c8.js"><link rel="prefetch" href="/assets/js/269.0029c735.js"><link rel="prefetch" href="/assets/js/27.35cd7490.js"><link rel="prefetch" href="/assets/js/270.1b7bd28f.js"><link rel="prefetch" href="/assets/js/271.d770801c.js"><link rel="prefetch" href="/assets/js/272.00d1c788.js"><link rel="prefetch" href="/assets/js/273.eef09449.js"><link rel="prefetch" href="/assets/js/274.ba4d252f.js"><link rel="prefetch" href="/assets/js/275.005d4e7e.js"><link rel="prefetch" href="/assets/js/276.0584c0ae.js"><link rel="prefetch" href="/assets/js/277.286662e4.js"><link rel="prefetch" href="/assets/js/278.b1e3d3cf.js"><link rel="prefetch" href="/assets/js/279.3c40e2d1.js"><link rel="prefetch" href="/assets/js/28.d01a395b.js"><link rel="prefetch" href="/assets/js/280.9d3c026d.js"><link rel="prefetch" href="/assets/js/281.d491b0f9.js"><link rel="prefetch" href="/assets/js/282.1cb27c9f.js"><link rel="prefetch" href="/assets/js/283.6ba8b407.js"><link rel="prefetch" href="/assets/js/284.af757d85.js"><link rel="prefetch" href="/assets/js/285.04b3bfcc.js"><link rel="prefetch" href="/assets/js/286.06d4607e.js"><link rel="prefetch" href="/assets/js/287.3319d6fd.js"><link rel="prefetch" href="/assets/js/288.668ebe2f.js"><link rel="prefetch" href="/assets/js/289.cae7634f.js"><link rel="prefetch" href="/assets/js/29.5507bd95.js"><link rel="prefetch" href="/assets/js/290.657bdfd6.js"><link rel="prefetch" href="/assets/js/291.d4ff094b.js"><link rel="prefetch" href="/assets/js/292.c7bacb14.js"><link rel="prefetch" href="/assets/js/293.35a0a923.js"><link rel="prefetch" href="/assets/js/294.71b58c4b.js"><link rel="prefetch" href="/assets/js/295.933b83a8.js"><link rel="prefetch" href="/assets/js/296.5d1743c4.js"><link rel="prefetch" href="/assets/js/297.ce20fec0.js"><link rel="prefetch" href="/assets/js/298.a091e8dc.js"><link rel="prefetch" href="/assets/js/299.e3840071.js"><link rel="prefetch" href="/assets/js/30.e0532eb9.js"><link rel="prefetch" href="/assets/js/300.a90025fe.js"><link rel="prefetch" href="/assets/js/301.736bd288.js"><link rel="prefetch" href="/assets/js/302.0b4e5a4b.js"><link rel="prefetch" href="/assets/js/303.bc7447b5.js"><link rel="prefetch" href="/assets/js/304.9c6d75fb.js"><link rel="prefetch" href="/assets/js/305.9510c83b.js"><link rel="prefetch" href="/assets/js/306.586c4cc0.js"><link rel="prefetch" href="/assets/js/307.6d5ca553.js"><link rel="prefetch" href="/assets/js/308.1c5438ba.js"><link rel="prefetch" href="/assets/js/309.094e0741.js"><link rel="prefetch" href="/assets/js/31.987d9766.js"><link rel="prefetch" href="/assets/js/310.f5f5c340.js"><link rel="prefetch" href="/assets/js/311.b87eac53.js"><link rel="prefetch" href="/assets/js/312.b999fff4.js"><link rel="prefetch" href="/assets/js/313.03652026.js"><link rel="prefetch" href="/assets/js/314.35c2c161.js"><link rel="prefetch" href="/assets/js/315.1abcde33.js"><link rel="prefetch" href="/assets/js/32.eb5a5673.js"><link rel="prefetch" href="/assets/js/33.4ac16ea0.js"><link rel="prefetch" href="/assets/js/34.a2b3c90c.js"><link rel="prefetch" href="/assets/js/35.a798ca1a.js"><link rel="prefetch" href="/assets/js/36.73dfb9ef.js"><link rel="prefetch" href="/assets/js/37.738c1a17.js"><link rel="prefetch" href="/assets/js/38.f78a3c94.js"><link rel="prefetch" href="/assets/js/39.e8cbaea1.js"><link rel="prefetch" href="/assets/js/4.30856fce.js"><link rel="prefetch" href="/assets/js/40.6818c7ea.js"><link rel="prefetch" href="/assets/js/41.a6bffe28.js"><link rel="prefetch" href="/assets/js/42.01f1d912.js"><link rel="prefetch" href="/assets/js/43.e4b5794f.js"><link rel="prefetch" href="/assets/js/44.55d9c3b9.js"><link rel="prefetch" href="/assets/js/45.2da966ea.js"><link rel="prefetch" href="/assets/js/46.527d7a9f.js"><link rel="prefetch" href="/assets/js/47.be7825ea.js"><link rel="prefetch" href="/assets/js/48.895e38d6.js"><link rel="prefetch" href="/assets/js/49.06afb30f.js"><link rel="prefetch" href="/assets/js/5.32d4cced.js"><link rel="prefetch" href="/assets/js/50.2bee94ed.js"><link rel="prefetch" href="/assets/js/51.86a79816.js"><link rel="prefetch" href="/assets/js/52.1161afbc.js"><link rel="prefetch" href="/assets/js/53.de72ed46.js"><link rel="prefetch" href="/assets/js/54.147e674e.js"><link rel="prefetch" href="/assets/js/55.9cf66aae.js"><link rel="prefetch" href="/assets/js/56.98261658.js"><link rel="prefetch" href="/assets/js/57.e55f4cc7.js"><link rel="prefetch" href="/assets/js/58.5ffee4dc.js"><link rel="prefetch" href="/assets/js/59.26c58ec3.js"><link rel="prefetch" href="/assets/js/6.a8dac332.js"><link rel="prefetch" href="/assets/js/60.5f9fcd83.js"><link rel="prefetch" href="/assets/js/61.18966166.js"><link rel="prefetch" href="/assets/js/62.a5baa5d4.js"><link rel="prefetch" href="/assets/js/63.6d9ea4f9.js"><link rel="prefetch" href="/assets/js/64.dc5ed5ad.js"><link rel="prefetch" href="/assets/js/65.c0c34241.js"><link rel="prefetch" href="/assets/js/66.2466b1fe.js"><link rel="prefetch" href="/assets/js/67.7a876940.js"><link rel="prefetch" href="/assets/js/68.24448921.js"><link rel="prefetch" href="/assets/js/69.c126a190.js"><link rel="prefetch" href="/assets/js/7.a85ae9ce.js"><link rel="prefetch" href="/assets/js/70.be781499.js"><link rel="prefetch" href="/assets/js/71.765e2d70.js"><link rel="prefetch" href="/assets/js/72.b13be4f3.js"><link rel="prefetch" href="/assets/js/73.87fe7cc2.js"><link rel="prefetch" href="/assets/js/74.3ee1bc51.js"><link rel="prefetch" href="/assets/js/75.0fb8f7b6.js"><link rel="prefetch" href="/assets/js/76.2a2314d4.js"><link rel="prefetch" href="/assets/js/77.f462930d.js"><link rel="prefetch" href="/assets/js/78.5a31a5a3.js"><link rel="prefetch" href="/assets/js/79.2f48e5ca.js"><link rel="prefetch" href="/assets/js/8.dbca2b31.js"><link rel="prefetch" href="/assets/js/80.4b73e29a.js"><link rel="prefetch" href="/assets/js/81.b7278dd1.js"><link rel="prefetch" href="/assets/js/82.c0d290b3.js"><link rel="prefetch" href="/assets/js/83.a5c1c1d3.js"><link rel="prefetch" href="/assets/js/84.fc5af720.js"><link rel="prefetch" href="/assets/js/85.3864c6e8.js"><link rel="prefetch" href="/assets/js/86.7fe1bc2b.js"><link rel="prefetch" href="/assets/js/87.0de66e95.js"><link rel="prefetch" href="/assets/js/88.435035c5.js"><link rel="prefetch" href="/assets/js/89.7d0ea427.js"><link rel="prefetch" href="/assets/js/9.ed9a9b09.js"><link rel="prefetch" href="/assets/js/90.b9967b51.js"><link rel="prefetch" href="/assets/js/91.c1f780c4.js"><link rel="prefetch" href="/assets/js/92.d08bdef7.js"><link rel="prefetch" href="/assets/js/93.2ee03eed.js"><link rel="prefetch" href="/assets/js/94.74cb8cac.js"><link rel="prefetch" href="/assets/js/95.be80f207.js"><link rel="prefetch" href="/assets/js/96.dafba035.js"><link rel="prefetch" href="/assets/js/97.754c7758.js"><link rel="prefetch" href="/assets/js/98.496cef28.js"><link rel="prefetch" href="/assets/js/99.a427ee17.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a0dd32a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">刘一笔的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/LearnTech/" class="nav-link router-link-active">
  技术学习
</a></div><div class="nav-item"><a href="/Projects/" class="nav-link">
  项目记录
</a></div><div class="nav-item"><a href="/YearReview/" class="nav-link">
  年终回顾
</a></div><div class="nav-item"><a href="/Reading/" class="nav-link">
  阅读记录
</a></div><div class="nav-item"><a href="/IdeaPills/" class="nav-link">
  闪念
</a></div><div class="nav-item"><a href="/CodingTool/" class="nav-link">
  编程工具
</a></div><div class="nav-item"><a href="https://github.com/OrangeSAM" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链" class="dropdown-title"><span class="title">友链</span> <span class="arrow down"></span></button> <button type="button" aria-label="友链" class="mobile-dropdown-title"><span class="title">友链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.lxchuan12.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  若川博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://wind-nest.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  森淼
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.mybeifeng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  北风
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/LearnTech/" class="nav-link router-link-active">
  技术学习
</a></div><div class="nav-item"><a href="/Projects/" class="nav-link">
  项目记录
</a></div><div class="nav-item"><a href="/YearReview/" class="nav-link">
  年终回顾
</a></div><div class="nav-item"><a href="/Reading/" class="nav-link">
  阅读记录
</a></div><div class="nav-item"><a href="/IdeaPills/" class="nav-link">
  闪念
</a></div><div class="nav-item"><a href="/CodingTool/" class="nav-link">
  编程工具
</a></div><div class="nav-item"><a href="https://github.com/OrangeSAM" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链" class="dropdown-title"><span class="title">友链</span> <span class="arrow down"></span></button> <button type="button" aria-label="友链" class="mobile-dropdown-title"><span class="title">友链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.lxchuan12.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  若川博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://wind-nest.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  森淼
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.mybeifeng.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  北风
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Browser</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTTP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Javascript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/LearnTech/Javascript/apply_call_bind.html" class="sidebar-link">JS | call apply bind</a></li><li><a href="/LearnTech/Javascript/babel.html" class="sidebar-link">JS | babel</a></li><li><a href="/LearnTech/Javascript/eventHub.html" class="sidebar-link">eventHub的实现</a></li><li><a href="/LearnTech/Javascript/event_bind.html" class="sidebar-link">JS | 事件绑定</a></li><li><a href="/LearnTech/Javascript/event_loop_translate.html" class="sidebar-link">JS | EventLoop</a></li><li><a href="/LearnTech/Javascript/filter_in_array.html" class="sidebar-link">数组中的filter方法</a></li><li><a href="/LearnTech/Javascript/forin_forof.html" class="sidebar-link">JS | for in 和 for of的异同</a></li><li><a href="/LearnTech/Javascript/func_declare_expression.html" class="sidebar-link">函数声明和表达式</a></li><li><a href="/LearnTech/Javascript/hand_writing.html" class="sidebar-link">JS | 各种手写</a></li><li><a href="/LearnTech/Javascript/Iterator_generator.html" class="sidebar-link">JS | 迭代器和生成器</a></li><li><a href="/LearnTech/Javascript/JavaScript中的继承实现.html" class="sidebar-link">JS | 继承</a></li><li><a href="/LearnTech/Javascript/js_arrow_func.html" class="sidebar-link">JS | 箭头函数</a></li><li><a href="/LearnTech/Javascript/js_async.html" class="sidebar-link">JS | 异步</a></li><li><a href="/LearnTech/Javascript/js_dataType.html" class="sidebar-link">JS | 数据类型</a></li><li><a href="/LearnTech/Javascript/js_datatype_convert.html" class="sidebar-link">数据类型转换</a></li><li><a href="/LearnTech/Javascript/js_destructuring_assign.html" class="sidebar-link">JS | 解构赋值</a></li><li><a href="/LearnTech/Javascript/js_excute_context.html" class="sidebar-link">JS | 执行上下文</a></li><li><a href="/LearnTech/Javascript/js_grammar.html" class="sidebar-link">javascript语法</a></li><li><a href="/LearnTech/Javascript/js_modules.html" aria-current="page" class="active sidebar-link">JavaScript 和 Node.js 中的模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#模块化要解决的问题" class="sidebar-link">模块化要解决的问题</a></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#模块化的历史" class="sidebar-link">模块化的历史</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#早期模块化产生的原因" class="sidebar-link">早期模块化产生的原因</a></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#历史以来的解决方案" class="sidebar-link">历史以来的解决方案</a></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#闭包模块化" class="sidebar-link" style="padding-left:3rem;">闭包模块化</a></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#amd、cmd、umd等等" class="sidebar-link" style="padding-left:3rem;">AMD、CMD、UMD等等</a></li></ul></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#正当时的模块化方案" class="sidebar-link">正当时的模块化方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#commonjs" class="sidebar-link">CommonJS</a></li></ul></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#cjs-和esm-值拷贝-值引用问题" class="sidebar-link">cjs 和esm 值拷贝 值引用问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#es-modules" class="sidebar-link">ES Modules</a></li></ul></li><li class="sidebar-sub-header"><a href="/LearnTech/Javascript/js_modules.html#参考文章" class="sidebar-link">参考文章</a></li></ul></li><li><a href="/LearnTech/Javascript/js_new.html" class="sidebar-link">JS | new的执行</a></li><li><a href="/LearnTech/Javascript/js_new_api.html" class="sidebar-link">新API</a></li><li><a href="/LearnTech/Javascript/new_string.html" class="sidebar-link">JS | 新版字符串</a></li><li><a href="/LearnTech/Javascript/let_const_interview.html" class="sidebar-link">JS | let &amp; const</a></li><li><a href="/LearnTech/Javascript/property_modification.html" class="sidebar-link">属性修饰符</a></li><li><a href="/LearnTech/Javascript/this.html" class="sidebar-link">JS | this关键字</a></li><li><a href="/LearnTech/Javascript/reduce_in_array.html" class="sidebar-link">JS | reduce</a></li><li><a href="/LearnTech/Javascript/tool_function.html" class="sidebar-link">js中的工具函数</a></li><li><a href="/LearnTech/Javascript/js_oop.html" class="sidebar-link">JS | 面向对象</a></li><li><a href="/LearnTech/Javascript/what_is_js.html" class="sidebar-link">什么是JavaScript</a></li><li><a href="/LearnTech/Javascript/window上有用的属性和方法.html" class="sidebar-link">window上有用的属性和方法</a></li><li><a href="/LearnTech/Javascript/原型和原型链.html" class="sidebar-link">JS | 原型和原型链</a></li><li><a href="/LearnTech/Javascript/防抖和节流.html" class="sidebar-link">防抖和节流</a></li><li><a href="/LearnTech/Javascript/高级程序设计第四版笔记.html" class="sidebar-link">高级程序设计第四版</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>这几天在研究webpack打包机制的时候，发现其中出现了不少关于模块化的知识，有感模块化作为打包前置知识的重要性，特写一篇以作梳理。</p> <p>什么资料都不看的前提下，简单回想了一下，脑里大概仅存一下几点（要是面试必挂...</p> <ol><li>模块化有很多种：AMD、UMD、ES modules</li> <li>在还没有 ES6 的模块化机制前，见得比较多的还是立即执行函数实现的模块化</li> <li>Node 端的模块化和 Web 端的又不一样</li></ol> <h2 id="模块化要解决的问题"><a href="#模块化要解决的问题" class="header-anchor">#</a> 模块化要解决的问题</h2> <ol><li>全局变量污染</li> <li>依赖管理混乱</li></ol> <h2 id="模块化的历史"><a href="#模块化的历史" class="header-anchor">#</a> 模块化的历史</h2> <h3 id="早期模块化产生的原因"><a href="#早期模块化产生的原因" class="header-anchor">#</a> 早期模块化产生的原因</h3> <ul><li>那个时候没有let，声明的变量很容易变为全局变量，即便有语言的闭包特性可以减少全局变量。但项目一大，也不可避免的容易造成全局变量污染。</li> <li>此外，还得通过人来维护script 脚本的引入顺序</li></ul> <h3 id="历史以来的解决方案"><a href="#历史以来的解决方案" class="header-anchor">#</a> 历史以来的解决方案</h3> <h4 id="闭包模块化"><a href="#闭包模块化" class="header-anchor">#</a> 闭包模块化</h4> <p>利用JavaScript的IIFE（立即执行函数）和闭包的特性，将所依赖的外部变量传给一个包装了自身代码的匿名函数，在函数内部就可以使用这些依赖，最后在函数结尾把自身暴露给window。</p> <p>可以点击这个 <a href="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 浏览器打开，搜索window.jQuery。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">root</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  root<span class="token punctuation">.</span>jQuery <span class="token operator">=</span> root<span class="token punctuation">.</span>$ <span class="token operator">=</span> jQuery
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>优点</strong></p> <ul><li>一定程度上减少了全局变量</li></ul> <p><strong>缺点</strong></p> <ul><li>跨文件使用，依然得挂载变量到全局变量上</li> <li>截止到目前，都还只是语言层面取巧的实现，没有一个规范</li> <li>当需要在模块内部使用全局变量时，必须显式注入全局变量，比如jQuery</li></ul> <h4 id="amd、cmd、umd等等"><a href="#amd、cmd、umd等等" class="header-anchor">#</a> AMD、CMD、UMD等等</h4> <p>此处略去不做展开，大部分都已成为早期开发者的记忆。后文主要分享 CommonJs 和 ES Modules 。</p> <h2 id="正当时的模块化方案"><a href="#正当时的模块化方案" class="header-anchor">#</a> 正当时的模块化方案</h2> <h3 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h3> <p>CommonJS是一系列标准规范的统称，ServerJS(Modules/0.1) =&gt; CommonJS(Modules/1.0) =&gt; Modules/1.1，Node.JS体系下的模块化即采用Modules/1.0方案实现。</p> <p>在CommonJS中，模块的加载机制是，
输入的是被输出的值的拷贝，也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。</p> <p>在CommonJS中，module代表整个模块，exports代表对外暴露的属性。</p> <p>CommonJS中导出引入的基本语法：</p> <p>对于导出，有两种写法</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 一</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sam'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">29</span>
<span class="token punctuation">}</span>

<span class="token comment">// 二</span>
exports<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'sam'</span>
exports<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">29</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对于引入，反正导出的是对象，想怎么引就怎么引</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>add<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> add <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add

<span class="token keyword">const</span> math <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./math'</span><span class="token punctuation">)</span>
math<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Node.js实现模块化的关键在于，在一个模块的代码被执行之前，Node.js都会为其包裹上一层如下的函数。详见<a href="http://nodejs.cn/api/modules.html#:~:text=%E5%BF%AB%EF%BC%8C%E6%9B%B4%E5%8F%AF%E9%9D%A0%E3%80%82-,%E6%A8%A1%E5%9D%97%E5%B0%81%E8%A3%85%E5%99%A8,-%23" target="_blank" rel="noopener noreferrer">文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __dirname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">// Module code actually lives in here</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样，能够将模块内的变量，无论let const，还是var 声明的，隔绝在模块内部而不是暴露全局作用域中。</p> <p>此外，这样还为模块内部提供了类全局的变量，比如module、require以及exports，以便进行模块化相关的操作；</p> <p>最后，还提供了两个常用的__filename和__dirname变量，这也是我们在Node.js中不用声明就可以使用它们的原因。</p> <p>在Node.js中，模块系统为js文件默认添加了导出引入相关的代码</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">exports</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 导出的内容</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 默认声明exports 并且赋值给module.exports</span>
<span class="token keyword">let</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports

<span class="token comment">// 最终导出的是module.exports</span>
<span class="token keyword">return</span> module<span class="token punctuation">.</span>exports
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这一点可以通过在模块中打印module得到印证，如下图，在打印的module对象中，有一个key为exports值为空对象的字段。</p> <p><img src="https://i.loli.net/2021/06/06/XnmWPNqzRp9sgjQ.png" alt=""></p> <p>common.js的特点是</p> <ul><li>所有代码都运行在模块作用域，不会污染全局作用域，模块可以多次加载，但只会在加载的时候运行一次，然后运行结果就被缓存了，以后再加载的，直接读取缓存结果</li> <li>模块的加载顺序，是按照代码出现的顺序同步加载的</li> <li>模块输入的值是复制（基础类型为复制，引用类型为值引用），也就是说，一旦输出一个值，模块内部的变化就影响不到这个值。</li></ul> <p><strong>exports 与 module.exports 的关系</strong></p> <p>在如下代码中，导入test.js 只会得到<code>getSome</code>函数，即便在test.js 内部的打印中可以看到<code>exports</code>属性的值是<code>getNum</code>函数</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// test.js</span>
<span class="token keyword">let</span> a  <span class="token operator">=</span> <span class="token number">123</span>
<span class="token keyword">const</span> <span class="token function-variable function">getSome</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this is get Some'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">getNum</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
exports<span class="token punctuation">.</span>getNum <span class="token operator">=</span> getNum
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> getSome
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> module<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token string">'exports'</span><span class="token punctuation">,</span> exports<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'-------------------------------'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>其实也很好理解，在common.js中 exports 和 module.exports 是指向同一块内存的，即<code>exports =&gt; {} &lt;=module.exports.</code>，exports 只是 module.exports 的快捷方式罢了。
module.exports直接等于一个函数的话，即主动将其与<code>exports</code>的关系解除绑定。</p> <p>这一点，在早期的<a href="https://nodejs.org/docs/latest-v0.12.x/api/modules.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中亦有过解释。如下图所示</p> <p><img src="https://i.loli.net/2021/06/06/Mhaf41dBODsQNKI.png" alt=""></p> <p>简单翻译文档大意：</p> <blockquote><p>在模块中可用的<code>exports</code>变量是以作为<code>module.exports</code>的引用开始的，和其他任何变量一样，如果你为其赋值一个新值，那么该变量则不再绑定到之前的值。
作为指导，如果您仍然对<code>exports</code>与<code>module.exports</code>的关系感到迷惑，可以忽视<code>exports</code>而只使用<code>module.exports</code>。</p></blockquote> <p>不过要深究的话，其实也不难，即涉及到JavaScript中的基础：值的引用。</p> <p>如下代码所示，在步骤一中，<code>a</code>与<code>b</code>指向同一个引用，所以都打印<code>sam</code>;</p> <p>在步骤二中，在变量<code>b</code>中把同一引用中的<code>name</code>值修改为<code>pepper</code>，所以都打印<code>pepper</code>;</p> <p>在步骤三中，为变量<code>b</code>赋值了一个新的对象，这样现在的<code>b</code>和之前的<code>b</code>所指向的引用就没有关系了，现在任何对b的改动都不会影响到之前的<code>a</code>。</p> <p><code>exports</code> 与 <code>module.exports</code> 亦是同理，模块中最终导出的东西都是module.exports里的，这也就解释了上面代码为什么只能拿到<code>getSome</code>的原因。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 步骤一</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sam'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 步骤二</span>
b<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'pepper'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 步骤三</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ee'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 运行 test.js 结果为：</span>
<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sam'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'sam'</span> <span class="token punctuation">}</span>

<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'perper'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'perper'</span> <span class="token punctuation">}</span>

<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'pepper'</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'ee'</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>从我的demo实验中，还可以得出一个结论，用module.export导出的内容，无法通过在模块内打印exports获得；而用exports导出的内容，可以通过在模块内打印module.exports获得。</p> <p>总结以上内容就是：</p> <ul><li><strong>module.exports 初始值为一个空对象 {}</strong></li> <li><strong>exports 是指向的 module.exports 的引用</strong></li> <li><strong>require() 返回的是 module.exports 而不是 exports</strong></li></ul> <h2 id="cjs-和esm-值拷贝-值引用问题"><a href="#cjs-和esm-值拷贝-值引用问题" class="header-anchor">#</a> cjs 和esm 值拷贝 值引用问题</h2> <p>结论</p> <ul><li>cjs 基本类型拷贝，引用类型浅拷贝</li> <li>esm 都是浅拷贝</li></ul> <p>require node 和 es6 都支持的引入语法
export/import 只有es6支持的导出导入
module.exports/exports 只有node支持的导出</p> <ol start="3"><li><p>Common.js的原理是什么 ES Modules的原理是什么</p></li> <li><p>他们的demo分别写个</p></li> <li><p>ES Modules 在Node.js的问题</p></li></ol> <h3 id="es-modules"><a href="#es-modules" class="header-anchor">#</a> ES Modules</h3> <p>ES6 模块的设计思想是尽量的静态化，使得编译时就能确定模块的依赖关系（node.js有编译的过程吗），以及输入输出的变量。
commonJS和AMD模块都只能在运行时确定这些东西，比如，CommonJS 模块就是对象，输入时必须查找对象属性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// CommonJS模块</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> stat<span class="token punctuation">,</span> exists<span class="token punctuation">,</span> readfile <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">let</span> _fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> stat <span class="token operator">=</span> _fs<span class="token punctuation">.</span>stat<span class="token punctuation">;</span>
<span class="token keyword">let</span> exists <span class="token operator">=</span> _fs<span class="token punctuation">.</span>exists<span class="token punctuation">;</span>
<span class="token keyword">let</span> readfile <span class="token operator">=</span> _fs<span class="token punctuation">.</span>readfile<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上面代码的实质是整体加载fs模块（即加载fs的所有方法），生成一个对象（_fs），然后再从这个对象上面读取 3 个方法。
这种加载称为“运行时加载”，因为只有运行时才能得到这个对象，导致完全没办法在编译时做“静态优化”。</p> <p>而ES module的模块不是对象，而是通过export命令显式指定输出的代码，再通过import命令输入。
ES6 模块使用import和export。
// ES6模块
import { stat, exists, readFile } from 'fs';
上面代码的实质是从fs模块加载 3 个方法，其他方法不加载。这种加载称为“编译时加载”或者静态加载，即 ES6 可以在编译时就完成模块加载，效率要比 CommonJS 模块的加载方式高。
当然，这也导致了没法引用 ES6 模块本身，因为它不是对象。</p> <p>ES6的模块自动采用严格模式，那如何确定这就是一个ES6模块呢。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'my_module'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面的代码不会报错，因为import的执行早于foo的调用。这种行为的本质是，import命令是编译阶段执行的，在代码运行之前。</p> <h2 id="参考文章"><a href="#参考文章" class="header-anchor">#</a> 参考文章</h2> <p>https://huangxuan.me/2015/07/09/js-module-7day/
<a href="https://segmentfault.com/a/1190000021438613" target="_blank" rel="noopener noreferrer">module.exports和exports的区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
https://segmentfault.com/a/1190000010426778
https://juejin.cn/post/6844903744518389768#heading-8
https://juejin.cn/post/6844903744518389768#heading-8</p> <p>https://juejin.cn/post/6940163713345257486#heading-17</p> <p>https://www.ruanyifeng.com/blog/2012/10/javascript_module.html
https://www.ruanyifeng.com/blog/2012/10/asynchronous_module_definition.html</p> <p>对于cjs esm 导出的值还是引用的问题
https://www.baobangdong.cn/use-webpack-to-understand-the-difference-between-commonjs-and-esmodules/</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">一笔写于:</span> <span class="time">6/9/2022, 4:36:43 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/LearnTech/Javascript/js_grammar.html" class="prev">
        javascript语法
      </a></span> <span class="next"><a href="/LearnTech/Javascript/js_new.html">
        JS | new的执行
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="wrap" data-v-8a4b0db0><div class="tips" data-v-8a4b0db0>扫码添加我的微信</div> <div class="img-wrap" data-v-8a4b0db0><img src="/assets/img/personal.ee8e3062.jpg" alt="个人" data-v-8a4b0db0> <div data-v-8a4b0db0>个人号</div> <img src="/assets/img/official.2918609b.jpg" alt="公众号" data-v-8a4b0db0> <div data-v-8a4b0db0>公众号</div></div></div></div></div>
    <script src="/assets/js/app.76e21587.js" defer></script><script src="/assets/js/2.ef2f9e2c.js" defer></script><script src="/assets/js/115.8f904d78.js" defer></script><script src="/assets/js/3.1b3369a5.js" defer></script>
  </body>
</html>
